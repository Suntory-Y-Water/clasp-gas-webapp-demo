# 要件定義書（GAS × clasp Webアプリ：Drive検索ビューア）

---

## 1. 目的
Google Apps Script と HtmlService を用い、`doGet()` でHTMLを返す形の**シンプルな社内向けWebアプリ**を構築する。  
また、**claspによるローカル開発環境**を活用して型補完・Git管理・デプロイの流れを実演し、記事内で「GASでも本格的なWebアプリ開発が可能である」ことを伝える。

---

## 2. アプリ概要
**名称**：Drive検索ビューア  
**概要**：Google Drive内のファイルをキーワード検索し、結果をWebページ上に一覧表示する。  
**想定利用者**：同一Google Workspaceドメイン内のユーザー（社内限定公開）  
**公開形態**：Webアプリ（Apps Scriptの「ウェブアプリケーションとして導入」機能を使用）

---

## 3. 機能要件

| 分類         | 機能名                      | 説明                                                                                         |
| ------------ | --------------------------- | -------------------------------------------------------------------------------------------- |
| 表示         | 検索フォーム表示            | `doGet()`でHTMLを返し、ブラウザ上に検索フォームを表示する。                                  |
| 検索         | ファイル検索                | ユーザーが入力したキーワードをもとに、`DriveApp.searchFiles()`を使用してファイルを取得する。 |
| 表示         | 検索結果表示                | ファイル名・最終更新日時をテーブル形式で画面に出力する。                                     |
| 通信         | クライアント→サーバ呼び出し | `google.script.run`を利用してHTML側からApps Script関数を呼び出す。                           |
| エラー処理   | 検索結果なし時のメッセージ  | 「該当するファイルがありません」と表示する。                                                 |
| セキュリティ | ドメイン制限公開            | 公開設定を「自分のドメイン内の全員」に限定する。                                             |

---

## 4. 非機能要件

| 項目           | 内容                                                        |
| -------------- | ----------------------------------------------------------- |
| 開発環境       | VS Code + clasp（Apps Script APIを有効化済み）              |
| 言語           | TypeScript / HTML / GAS                                     |
| バージョン管理 | GitHubでソース管理                                          |
| 型補完         | `@types/google-apps-script`を利用                           |
| デプロイ       | `clasp push` / `clasp deploy` によりWebアプリ公開           |
| メンテナンス性 | 最小限のコードで理解容易にする.                             |
| 利用スコープ   | `DriveApp` のみ（最小権限で動作）                           |

---

## 5. 画面仕様（概要）

**index.html**
- 検索フォーム（テキスト入力＋検索ボタン）
- 結果テーブル（ファイル名・更新日時）
- メッセージ表示領域（検索中・エラーなど）

**処理フロー**
1. ユーザーが検索キーワードを入力し「検索」ボタンを押下  
2. `google.script.run.withSuccessHandler()` でApps Script関数 `searchFiles()` を呼び出し  
3. サーバ側で `DriveApp.searchFiles()` により結果取得  
4. 検索結果をJSONで返し、HTMLで描画  

---

## 6. セキュリティ・アクセス制御
- 公開設定：「自分のドメイン内の全員」
- OAuthスコープ：`https://www.googleapis.com/auth/drive.readonly`
- 外部ライブラリ：使用しない（バンドル例は別記事で紹介予定）

---

## 7. 想定コード構成
現在のフォルダ構成を参考に必要最小限の実装を行うこと。

---

## 8. 成果物
- Webアプリが動作している状態（Drive検索が可能）
- claspプロジェクトとしてGitHubで管理可能な構成
- 記事で紹介可能な最小サンプルコード一式（再現性100%）

---

## 9. 今後の拡張候補（記事外）
- 検索結果のリンククリックでDriveを開く機能
- ページネーション
- 他API（GmailApp, SpreadsheetApp等）対応サンプル追加