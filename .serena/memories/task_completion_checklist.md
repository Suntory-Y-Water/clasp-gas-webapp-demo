# タスク完了時のチェックリスト

## コード変更後に必ず実行すること

### 1. リント + フォーマット

```bash
pnpm lint --write
```

または、修正が必要な箇所のみ確認：

```bash
pnpm lint
```

### 2. テスト実行

```bash
pnpm test
```

### 3. ビルド確認

```bash
pnpm run build
```

### 4. すべてをまとめて実行

```bash
pnpm check:all
```

このコマンドは以下を実行します：
- リント（自動修正付き）
- テスト

## デプロイ前の確認事項

### デプロイコマンド

```bash
pnpm run deploy
```

このコマンドは以下を順番に実行します：

1. `pnpm check:all`（リント + テスト）
2. `pnpm run build`（ビルド）
3. `pnpm run push`（GAS へプッシュ）

### デプロイ前にチェックすべき項目

- [ ] `.clasp.json` に正しい `scriptId` が設定されている
- [ ] `.env` ファイルに必要な環境変数が設定されている
- [ ] `appsscript.json` に必要な OAuth スコープが設定されている
- [ ] ビルドエラーがない
- [ ] テストが全て通過している
- [ ] リントエラーがない

## コミット時の自動チェック

Husky により、コミット時に以下が自動実行されます：

1. **Lint-Staged**
   - ステージングされたファイルのリント + フォーマット自動修正
2. **ビルド**
   - プロジェクト全体のビルド確認
3. **ビルド成果物の削除**
   - `build/` ディレクトリのクリーンアップ

**注意**: コミット前の自動チェックに失敗すると、コミットが中断されます。

## テストカバレッジの確認

カバレッジを確認したい場合：

```bash
pnpm test:cov
```

カバレッジレポートは `./coverage` ディレクトリに生成されます。

## 開発時の推奨フロー

1. コードを変更
2. `pnpm test:watch` でテストを監視（オプション）
3. `pnpm check:all` で最終確認
4. Git コミット（自動チェックが実行される）
5. 必要に応じて `pnpm run deploy` で GAS にデプロイ
